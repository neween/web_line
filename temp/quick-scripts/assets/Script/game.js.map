{"version":3,"sources":["game.js"],"names":["cc","Class","extends","Component","properties","cell","raw","MAX_LINE","warningBg","Sprite","gridprefab","Prefab","time","Label","score","gamenode","Node","pause","gridBaseNode","drawline","Graphics","audio","url","AudioClip","default","sound","onLoad","gridList","selectGridList","Array","currCell","isDown","x","y","audioEngine","playMusic","self","on","event","onTouchCall","adjustOnline","log","onPause","createGrid","posx","posy","enemy","instantiate","parent","random","Math","floor","getComponent","init","v2","size","getContentSize","colCell","width","rawCell","height","i","j","node","isfist","pos","getLocation","start","getPosition","check","length","element","push","play","onDrawLine","startc","moveTo","find","value","index","arr","checkSametype","getType","checkAreaIn","removeFromParent","isDead","stop","playEffect","clear","cleanupMap","addCellIntoMap","dead","_dead","distanct","z","down","drop","swapCell","pos1","pos2","swap","newNode","end","lineTo","stroke"],"mappings":"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","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        cell:6,\r\n        raw:7,\r\n        MAX_LINE:2,\r\n        warningBg:cc.Sprite,\r\n        gridprefab: cc.Prefab,\r\n        time:cc.Label,\r\n        score:cc.Label,\r\n        gamenode:cc.Node,\r\n        pause:cc.Node,\r\n        gridBaseNode:cc.Node,\r\n\r\n        drawline:cc.Graphics,\r\n        audio: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        },\r\n\r\n        sound: {\r\n            url: cc.AudioClip,\r\n            default: null\r\n        }\r\n    },\r\n\r\n\r\n    onLoad () {\r\n        this.gridList = [];\r\n        this.selectGridList = new Array();\r\n        this.currCell = null;\r\n        this.isDown = false;//是否点击了\r\n\r\n        for(var x=0;x<this.cell;x++){\r\n            this.gridList[x]=new Array();        //声明二维数组\r\n            for(var y=0;y<this.raw;y++){\r\n                this.gridList[x][y]=0;          //数组初始化为0\r\n            }\r\n        }\r\n\r\n        cc.audioEngine.playMusic(this.audio, true);\r\n\r\n        var self = this;\r\n        this.gridBaseNode.on('touchstart', function ( event ) {\r\n            self.isDown = true;\r\n            self.onTouchCall(true,event);\r\n        });\r\n        this.gridBaseNode.on('touchmove', function ( event ) {\r\n            self.onTouchCall(false,event);\r\n        });\r\n\r\n        this.gridBaseNode.on('touchend', function ( event ) {\r\n            //self.onTouchCall(false,event);\r\n            self.adjustOnline();\r\n            cc.log(\"touchend..........\");\r\n        });\r\n        this.gridBaseNode.on('touchcancel', function ( event ) {\r\n            self.adjustOnline();\r\n        });\r\n\r\n        this.onPause();\r\n    },\r\n\r\n    createGrid: function (posx,posy,x,y) {\r\n        var enemy = cc.instantiate(this.gridprefab); // 创建节点\r\n        enemy.parent = this.gridBaseNode; // 将生成的敌人加入节点树\r\n        var random = Math.floor(Math.random()*100)%8;\r\n        enemy.getComponent('grid').init(random,cc.v2(posx,posy),x,y); //接下来就可以调用 enemy 身上的脚本进行初始化\r\n        return enemy\r\n    },\r\n\r\n    onPause:function(){\r\n        var size = this.gridBaseNode.getContentSize();\r\n        this.colCell = size.width/this.cell;\r\n        this.rawCell = size.height/this.raw;\r\n        for(let i=0;i<this.cell;i++){\r\n            for(let j=0;j<this.raw;j++){\r\n                var x = this.colCell/2 + this.colCell*i;\r\n                var y = this.rawCell/2 + this.rawCell*j;\r\n                var node = this.createGrid(x,y,i,j);\r\n                this.gridList[i][j] = node;\r\n            }\r\n        }\r\n        \r\n    },\r\n\r\n    onTouchCall:function(isfist,event){\r\n        \r\n        if(!this.isDown){\r\n            return;\r\n        }\r\n\r\n        var pos = event.getLocation();\r\n        var start = this.gridBaseNode.getPosition()\r\n        var x = Math.floor((pos.x - start.x)/this.colCell)\r\n        var y = Math.floor((pos.y - start.y)/this.rawCell)\r\n\r\n        var cell = this.gridList[x][y];\r\n        if(this.check(cell,x,y)){\r\n            return;\r\n        }\r\n        \r\n        cc.log(\"点到了格子为:\",x,y);\r\n        for (let i = 0; i < this.selectGridList.length; i++) {\r\n            const element = this.selectGridList[i];\r\n            if(element == cell){\r\n                return;\r\n            }\r\n        }\r\n        this.selectGridList.push(cell);\r\n        cell.getComponent('grid').play();\r\n\r\n        //连线上一个\r\n        if(this.currCell){\r\n            this.onDrawLine(cell.getPosition());\r\n        }else{\r\n            var startc = cell.getPosition();\r\n            this.drawline.moveTo(startc.x,startc.y);\r\n        }\r\n\r\n        this.currCell = cell;\r\n    },\r\n\r\n    /**\r\n     * 判断是否可以消除\r\n     */\r\n    check:function(cell,x,y){\r\n        if(!this.currCell){\r\n            cc.log(\"还没开始选择到格子\");\r\n            return false;\r\n        }\r\n        \r\n        if(this.selectGridList.find(function(value, index, arr){\r\n            return value === cell;\r\n        })){\r\n            cc.log(\"格子已经被选中\");\r\n            return true;\r\n        }\r\n\r\n        if(!cell.getComponent('grid').checkSametype(this.currCell.getComponent('grid').getType())){\r\n            cc.log(\"选中的格子类型不同\");\r\n            return true;\r\n        }\r\n\r\n        if(!cell.getComponent('grid').checkAreaIn(this.currCell)){\r\n            cc.log(\"选中的格子不在上一个元素的周围\");\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    },\r\n\r\n\r\n    adjustOnline:function(){\r\n    \r\n        for (let i = 0; i < this.selectGridList.length; i++) {\r\n            const element = this.selectGridList[i];\r\n            if(this.selectGridList.length >= this.MAX_LINE){\r\n                element.removeFromParent(true);\r\n                element.getComponent('grid').isDead(true);\r\n            }else{\r\n                element.getComponent('grid').stop();\r\n            }\r\n        }\r\n        cc.audioEngine.playEffect(this.sound);\r\n\r\n        this.selectGridList = [];\r\n        this.currCell = null\r\n        this.isDown = false;\r\n        this.drawline.clear();\r\n\r\n        //map重绘\r\n        this.cleanupMap();\r\n\r\n        //补全map\r\n        this.addCellIntoMap();\r\n    },\r\n\r\n    cleanupMap:function(){\r\n        for(let i = 0;i<this.gridList.length;i++){\r\n            for(let j = 1;j<this.gridList[i].length;j++){\r\n                var node = this.gridList[i][j]\r\n                var dead = node.getComponent('grid')._dead;\r\n                if(dead){\r\n                    //this.gridList[i][j] = null;\r\n                    continue;\r\n                }\r\n                var distanct = 0;\r\n                var z=j-1;\r\n                while( z >= 0){\r\n                    var down = this.gridList[i][z]\r\n                    if(down.getComponent('grid')._dead){\r\n                        ++distanct;\r\n                    }\r\n                    --z;\r\n                }\r\n                if(distanct >0){\r\n                    cc.log(\"位置:(\"+i+ \",\"+j+\") 需要移动格子数为 : \" + distanct);\r\n                     //移动\r\n                    node.getComponent('grid').drop(0,j - distanct,0,distanct * this.rawCell);\r\n                    this.swapCell(cc.v2(i,j),cc.v2(i,j-distanct));\r\n                }\r\n\r\n               \r\n            }\r\n        }\r\n    },\r\n\r\n    swapCell:function(pos1,pos2){\r\n        var swap = this.gridList[pos1.x][pos1.y];\r\n        this.gridList[pos1.x][pos1.y] = this.gridList[pos2.x][pos2.y];\r\n        this.gridList[pos2.x][pos2.y] = swap;\r\n    },\r\n\r\n    addCellIntoMap:function(){\r\n         for(let i = 0;i<this.gridList.length;i++){\r\n            for(let j = 1;j<this.gridList[i].length;j++){\r\n                var node = this.gridList[i][j]\r\n                var dead = node.getComponent('grid')._dead;\r\n                if(dead){\r\n                    this.gridList[i][j].removeFromParent(true);\r\n                    this.gridList[i][j] = null;\r\n                    //创建一个并飞到该地方\r\n                    var x = this.colCell/2 + this.colCell*i;\r\n                    var y = this.rawCell/2 + this.rawCell*j;\r\n                    var newNode = this.createGrid(x,y,i,j);\r\n                    this.gridList[i][j] = newNode;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    onDrawLine:function(end){\r\n        this.drawline.lineTo(end.x,end.y);\r\n        this.drawline.stroke();\r\n    }\r\n});\r\n"]}